{
  "title": "Payments Overview",
  "schemaVersion": 39,
  "version": 2,
  "panels": [
    {
      "type": "stat",
      "title": "P2P Transfers/min",
      "gridPos": {"x": 0, "y": 0, "w": 8, "h": 6},
      "targets": [
        {"expr": "sum(rate(payments_transfers_total{kind=\"p2p\"}[5m]))"}
      ]
    },
    {
      "type": "stat",
      "title": "Topups/min",
      "gridPos": {"x": 8, "y": 0, "w": 8, "h": 6},
      "targets": [
        {"expr": "sum(rate(payments_transfers_total{kind=\"topup\"}[5m]))"}
      ]
    },
    {
      "type": "stat",
      "title": "QR Pays/min",
      "gridPos": {"x": 16, "y": 0, "w": 8, "h": 6},
      "targets": [
        {"expr": "sum(rate(payments_qr_total[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Payment Requests Actions",
      "gridPos": {"x": 0, "y": 6, "w": 24, "h": 8},
      "targets": [
        {"expr": "sum by (action) (rate(payments_requests_total[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Webhook Deliveries/min",
      "gridPos": {"x": 0, "y": 14, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum by (status) (rate(payments_webhook_deliveries_total[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Webhook Attempts/min",
      "gridPos": {"x": 12, "y": 14, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum by (result) (rate(payments_webhook_attempts_total[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Links/min",
      "gridPos": {"x": 0, "y": 22, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum by (action) (rate(payments_links_total[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Refunds/min",
      "gridPos": {"x": 12, "y": 22, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum by (status) (rate(payments_refunds_total[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Subscriptions/min",
      "gridPos": {"x": 0, "y": 30, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum by (action) (rate(payments_subscriptions_total[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Gross (SYP)/min",
      "gridPos": {"x": 12, "y": 30, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum(rate(payments_merchant_gross_cents[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Fees (SYP)/min",
      "gridPos": {"x": 0, "y": 38, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum(rate(payments_merchant_fees_cents[5m]))"}
      ]
    },
    {
      "type": "graph",
      "title": "Net Revenue (SYP)/min",
      "gridPos": {"x": 12, "y": 38, "w": 12, "h": 8},
      "targets": [
        {"expr": "sum(rate(payments_merchant_gross_cents[5m])) - sum(rate(payments_merchant_fees_cents[5m])) - sum(rate(payments_refunds_cents[5m]))"}
      ]
    },
    {
      "type": "stat",
      "title": "Refunds/Gross %",
      "gridPos": {"x": 0, "y": 46, "w": 8, "h": 6},
      "targets": [
        {"expr": "100 * (sum(rate(payments_refunds_cents[5m])) / sum(rate(payments_merchant_gross_cents[5m])))"}
      ]
    }
    ,
    {
      "type": "timeseries",
      "title": "HTTP p95/p99 latency (s)",
      "gridPos": {"x": 0, "y": 52, "w": 24, "h": 8},
      "targets": [
        {"expr": "histogram_quantile(0.95, sum by (le) (rate(http_request_duration_seconds_bucket{job=\\\"payments\\\"}[5m])))", "refId": "A"},
        {"expr": "histogram_quantile(0.99, sum by (le) (rate(http_request_duration_seconds_bucket{job=\\\"payments\\\"}[5m])))", "refId": "B"}
      ]
    }
  ]
}
